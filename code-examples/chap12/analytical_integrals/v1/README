The naive implementation with the DP top-down approach
